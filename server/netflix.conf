server {
    listen 80; # редирект с 80 порта
    server_name  localhost; # переименовать потом

    # для статики
    location = "/" {
        root /files # папка на сервере
        index index.html
    }

    # прокси к нашему сервису
    location /api/v1 {
      add_header 'Access-Control-Allow-Origin' "$http_origin" always;
      add_header 'Access-Control-Allow-Credentials' 'true' always;
      add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE, OPTIONS' always;
      add_header 'Access-Control-Allow-Headers' 'User-Agent,Keep-Alive,Content-Type,X-CSRF-Token' always;

      if ($request_method = OPTIONS) {
           add_header 'Access-Control-Max-Age' 600; #максимальное время в хромиуме
           add_header 'Content-Type' 'text/plain charset=UTF-8';
           add_header 'Content-Length' 0;
           return 204;
       }
       proxy_buffering off;
       proxy_pass http://main:8000/api/v1/;
     }

}
